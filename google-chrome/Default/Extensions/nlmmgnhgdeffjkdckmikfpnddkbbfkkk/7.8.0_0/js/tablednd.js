/*!
 * Based on code by DenisH
 * WWW: http://www.isocra.com/
 * with modifications by T. H. Doan
 */
function doMouseMove(n){var u,i,r,t;if(oCT&&oCT.dragObject)return u=oCT.mouseCoords(n),i=u.y-oCT.mouseOffset.y,i!==oCT.oldY&&(r=i>oCT.oldY,oCT.oldY=i,oCT.dragObject.style.background="#369",oCT.dragObject.lastChild.style.background="transparent",oCT.dragObject.style.webkitTransition="background .4s",t=oCT.findDropTargetRow(i),t&&(r&&oCT.dragObject!==t?oCT.dragObject.parentNode.insertBefore(oCT.dragObject,t.nextSibling):r||oCT.dragObject===t||oCT.dragObject.parentNode.insertBefore(oCT.dragObject,t))),!1;oTT&&oTT.style.display==="block"&&tooltip.pos(n)}function doMouseUp(){if(oCT&&oCT.dragObject){var n=oCT.dragObject;n.lastChild.style.background="";n.style.background="#fff";oCT.dragObject=null;oCT.onDrop(oCT.table,n);oCT=null}}function TableDnD(){this.dragObject=null;this.mouseOffset=null;this.table=null;this.oldY=0;this.init=function(n){var i,t,r;for(this.table=n,i=n.tBodies[0].rows,t=1,r=i.length;t<r;++t)this.makeDraggable(i[t])};this.onDrop=function(){err("fields")||disableButtons("fields",!1,!1)};this.getPosition=function(n){var t=0,i=0;for(n.offsetHeight===0&&(n=n.firstChild);n.offsetParent;)t+=n.offsetLeft,i+=n.offsetTop,n=n.offsetParent;return t+=n.offsetLeft,i+=n.offsetTop,{x:t,y:i}};this.mouseCoords=function(n){return{x:n.pageX,y:n.pageY}};this.getMouseOffset=function(n,t){var i=this.getPosition(n),r=this.mouseCoords(t);return{x:r.x-i.x,y:r.y-i.y}};this.makeDraggable=function(n){if(n){var t=this;n.onmousedown=function(n){var i=n.target;return i.nodeName==="TEXTAREA"||i.nodeName==="INPUT"||i.nodeName==="SELECT"||i.nodeName==="BUTTON"?!0:(oCT=t,t.dragObject=this,t.mouseOffset=t.getMouseOffset(this,n),!1)};n.style.cursor="move"}};this.findDropTargetRow=function(n){var r,i,e;for(n<=pageYOffset-oCT.mouseOffset.y+40?scrollBy(0,-4):n>=H+pageYOffset-oCT.mouseOffset.y-40&&scrollBy(0,4),r=this.table.tBodies[0].rows,i=1,e=r.length;i<e;++i){var t=r[i],u=this.getPosition(t).y,f=parseInt(t.offsetHeight)/2;if(t.offsetHeight===0&&(u=this.getPosition(t.firstChild).y,f=parseInt(t.firstChild.offsetHeight)/2),n>u-f&&n<u+f)return t}return null}}var oCT=null,table;D.onmousemove=doMouseMove;D.onmouseup=doMouseUp; 
